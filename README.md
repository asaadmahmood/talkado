# TodosPlus

A modern Todoist-style task management app built with React, Convex, and AI integration.

## Features

- **Smart Task Creation**: Add tasks naturally with AI-powered parsing
- **Voice Input**: Use your microphone to dictate tasks
- **Projects & Labels**: Organize tasks with projects and color-coded labels
- **Due Dates & Priorities**: Set due dates and priority levels (P1-P4)
- **Today View**: Focus on tasks due today
- **All Tasks View**: See all your incomplete tasks organized by category
- **Real-time Sync**: Changes sync instantly across all devices
- **Keyboard Shortcuts**: `Cmd/Ctrl+K` to focus quick add, `Enter` to add tasks

## Tech Stack

- **Frontend**: React 19 + TypeScript + Tailwind CSS + Vite
- **Backend**: Convex (database + real-time + auth)
- **AI**: OpenAI GPT-4o-mini with function calling
- **Auth**: Convex Auth with email/password
- **Voice**: Web Speech API
- **Testing**: Vitest + jsdom

## Setup

1. **Clone and install dependencies:**

   ```bash
   git clone <your-repo>
   cd talkado
   npm install
   ```

2. **Set up Convex:**

   ```bash
   npx convex dev
   ```

   This will create a new Convex project and generate your `.env.local` file.

3. **Configure OpenAI API:**

   ```bash
   npx convex env set OPENAI_API_KEY your_openai_api_key_here
   ```

   Get your API key from [OpenAI Platform](https://platform.openai.com/api-keys).

4. **Start the development server:**

   ```bash
   npm run dev
   ```

5. **Open your browser:**
   The app will open at `http://localhost:5173`

### Stripe setup (subscriptions)

If you plan to use the subscription flow, configure Stripe keys for your Convex deployment:

1. Create a `.env` file in the project root (do NOT commit this file). Add your real values:

   ```env
   STRIPE_SECRET_KEY=sk_test_xxx              # Standard secret key (not a restricted key)
   STRIPE_PRICE_ID=price_xxx                  # Recurring subscription price ID
   CLIENT_URL=http://localhost:5173           # Local dev URL
   # STRIPE_WEBHOOK_SECRET=whsec_xxx          # Optional: when you add webhooks
   ```

2. Sync these values into your Convex dev deployment:

   ```bash
   npm run env:sync
   ```

   - If the script creates a template `.env`, fill it and run the command again.

3. Verify the variables are set on Convex:

   ```bash
   npx convex env list
   ```

4. Restart your Convex dev server so actions pick up the new env.

Notes:

- Use matching modes: test keys (sk*test*) with test prices; live keys (sk*live*) with live prices.
- You can set production values the same way when deploying: run `npx convex env set ...` against prod.

## Environment Variables

The following environment variables are required:

- `OPENAI_API_KEY`: Your OpenAI API key (set via `convex env set`)
- `VITE_CONVEX_URL`: Automatically generated by Convex
- `STRIPE_SECRET_KEY` / `STRIPE_PRICE_ID` / `CLIENT_URL`: Required for Stripe subscription flow (synced with `npm run env:sync`)

`.env`, `.env.local`, and `.env.production` are already ignored via `.gitignore` to prevent secrets from being committed.

## Usage

### Quick Add

- Type tasks naturally: "Buy groceries tomorrow at 5pm #shopping p1"
- Use AI parsing for complex requests: "Schedule team meeting next Friday, review budget docs, and send follow-up emails"
- Voice input: Click the microphone button and speak your task

### Keyboard Shortcuts

- `Cmd/Ctrl+K`: Focus the quick add input
- `Enter`: Add the current task
- `Escape`: Cancel editing

### AI Task Parsing

The AI understands:

- **Due dates**: "tomorrow", "next Friday", "Dec 25", "in 2 weeks"
- **Times**: "at 5pm", "9:30am", "17:00" (defaults to 5pm if no time specified)
- **Priorities**: "p1", "priority 2", "high priority" (maps to P1-P4)
- **Projects**: Matches existing project names or suggests new ones
- **Labels**: "#urgent", "#work", "label:personal"

### Organization

- **Projects**: Group related tasks (work, personal, shopping)
- **Labels**: Cross-cutting categories with optional colors
- **Priorities**: P1 (highest) to P4 (lowest)
- **Due dates**: Optional dates with timezone support (defaults to Asia/Karachi +05:00)

## Testing

```bash
# Run tests
npm test

# Run tests once
npm run test:run

# Run with coverage
npm run test -- --coverage
```

## Development

The app follows a clean architecture:

```
src/
├── components/          # Reusable UI components
│   ├── Sidebar.tsx     # Navigation and project list
│   ├── QuickAdd.tsx    # Smart task input with AI
│   └── TaskItem.tsx    # Task display with editing
├── routes/             # Page components
│   ├── TodayPage.tsx   # Today's tasks
│   ├── AllPage.tsx     # All tasks by category
│   └── ProjectPage.tsx # Project-specific tasks
└── App.tsx            # Main app with routing

convex/
├── schema.ts          # Database schema
├── _utils.ts          # Shared utilities
├── projects.ts        # Project CRUD
├── labels.ts          # Label CRUD
├── tasks.ts           # Task CRUD
└── ai.ts             # AI task parsing
```

### Key Design Decisions

1. **No Subtasks**: Keeps the interface clean and focused
2. **Soft Deletes**: Tasks are marked as deleted, not removed
3. **Optimistic UI**: UI updates immediately, syncs in background
4. **Timezone Aware**: Dates are parsed in user's timezone
5. **Progressive Enhancement**: Voice input works where supported

## Contributing

1. Fork the repository
2. Create a feature branch
3. Add tests for new functionality
4. Ensure all tests pass
5. Submit a pull request

## License

MIT License - see LICENSE.txt for details.
